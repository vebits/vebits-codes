function random_hash(){var r="0123456789abcdef";let t="0x";for(let e=64;0<e;--e)t+=r[Math.floor(Math.random()*r.length)];return t}const tokenData={hash:random_hash()};console.log(tokenData);class Random{constructor(){this.useA=!1;function e(e){let r=parseInt(e.substr(0,8),16),t=parseInt(e.substr(8,8),16),n=parseInt(e.substr(16,8),16),o=parseInt(e.substr(24,8),16);return function(){r|=0,t|=0,n|=0,o|=0;var e=(r+t|0)+o|0;return o=o+1|0,r=t^t>>>9,t=n+(n<<3)|0,n=n<<21|n>>>11,n=n+e|0,(e>>>0)/4294967296}}this.prngA=new e(tokenData.hash.substr(2,32)),this.prngB=new e(tokenData.hash.substr(34,32));for(let e=0;e<1e6;e+=2)this.prngA(),this.prngB()}random_dec(){return this.useA=!this.useA,this.useA?this.prngA():this.prngB()}random_num(e,r){return e+(r-e)*this.random_dec()}random_int(e,r){return Math.floor(this.random_num(e,r+1))}random_bool(e){return this.random_dec()<e}random_choice(e){return e[this.random_int(0,e.length-1)]}}let DEFAULT_SIZE=1024,width,height,dim=(window.innerHeight>=1.2*window.innerWidth?(width=window.innerWidth,height=1.2*window.innerWidth):(height=window.innerHeight,width=window.innerHeight/1.2),Math.min(width,height)),m=dim/DEFAULT_SIZE,w=12*m,margin64=64*m,withPadding=!1;const angleGrid=[];let cols,rows,rnd;function setup(){seed=parseInt(tokenData.hash.slice(0,16),16),rnd=new Random,console.log("SEED:",seed),createCanvas(width,height),noLoop(),noiseSeed(seed),colorMode(HSL),strokeJoin(ROUND)}function draw(){let e=getPalettes(),o=weightFunction(e,e.map(e=>e.weight)),i=(background(color(o.background)),weightFunction([0,64,128,256],[2,2,1,.5])*m),r=rnd.random_int(2,32)*m;var d=.5<rnd.random_dec(),g=.9<rnd.random_dec(),h=weightFunction(["random","sequential","group"],[1,3,3]),n=weightFunction(["full","tri","duo"],[3,1,1]),l=.7<rnd.random_dec(),u=weightFunction(["standard","uneven","even"],[3,1,.5]);let t=.9<rnd.random_dec();var f=.95<rnd.random_dec();let k=!1;if(i===margin64&&(withPadding=!0,i=0),"uneven"===u&&(w=+m),l&&(group=!0,t=!1),t&&(r=rnd.random_int(10,32)*m),0===i&&.9<rnd.random_dec()&&(k=!0),0!==i&&strokeJoin(BEVEL),"duo"===n){for(;2<o.colors.length;){var v=Math.floor(rnd.random_dec()*o.colors.length);o.colors[v]!==o.background&&o.colors.splice(v,1)}o.stroke=o.colors[0]===o.background?o.colors[1]:o.colors[0]}if("tri"===n)for(;3<o.colors.length;){var b=Math.floor(rnd.random_dec()*o.colors.length);o.colors[b]!==o.background&&o.colors.splice(b,1)}t||f?(stroke(o.stroke),strokeWeight(2*m)):noStroke(),k&&(translate(width,height),rotate(PI)),initAngleGrid(d,u,g);const a=getPolys(d,i,r);e:for(let n=0;n<a.length;n++)if(!(a[n].length<margin64)){var c=o.colors.length;let e;if("group"===h){if(n%c==0)continue;e=.2<rnd.random_dec()?o.colors[Math.ceil(n/12%c)-1]:o.colors[rnd.random_int(0,o.colors.length-1)]}else e="sequential"===h?o.colors[n%c]:o.colors[rnd.random_int(0,o.colors.length-1)];if("sequential"!==h&&n<=1)for(;e===o.background;)e=o.colors[rnd.random_int(0,o.colors.length-1)];e=color(e),l&&e.setAlpha(rnd.random_num(.1,.9)),f?noFill():fill(e),beginShape();let r=0,t=0;var s=12*m;a[n].length%2!=0&&a[n].pop();for(let e=0;e<a[n].length;e+=1)if(g){if(d){if(a[n][a[n].length-1].x<width-i-2*m)break e}else if(a[n][a[n].length-1].x>i+s)break e;t=e>a[n].length/2?(0===e?vertex(Math.round(a[n][e].x),a[n][a[n].length-e].y):vertex(a[n][e].x,a[n][a[n].length-e].y),r=a[n][e].x,a[n][a[n].length-e].y):(0===e?vertex(Math.round(a[n][e].x),a[n][e].y):vertex(a[n][e].x,a[n][e].y),r=a[n][e].x,a[n][e].y)}else 0===e?vertex(Math.round(a[n][e].x),a[n][e].y):vertex(a[n][e].x,a[n][e].y),r=a[n][e].x,t=a[n][e].y;r=Math.round(r),d?(0===i?r<width-i-s?vertex(r,height):(vertex(width,t),vertex(width,height)):r<width-i-s?vertex(r,height):(vertex(width-i,t),vertex(width,height)),vertex(0,height)):(0===i?r<width-i-s?vertex(r,height):(vertex(i,t),vertex(i,height)):r<i+s?(vertex(i,t),vertex(0,height)):vertex(r,height),vertex(width,height)),endShape(CLOSE)}withPadding&&drawPadding(margin64,o.background),drawBorder(32*m,o.background,o.stroke),console.log(calculateFeatures(tokenData))}function Point(e,r){this.x=e,this.y=r}function getPolys(o,i,e){const d=[];var h=withPadding?margin64:i;for(let n=h;n<height;n+=e){let e=o?i:width-i,r=n,t=[];for(;o?e<width:e>i;){if(r<h){t=[];break}if(e<i||e>width-(0===i?0:i)||r<i||r>height-(withPadding?margin64:0))break;t.push(new Point(e,r));var a=int(e/w),c=int(r/w),a=angleGrid[a][c],c=1e-4*width*cos(a),a=1e-4*height*sin(a);o?(e-=c,r-=a):(e+=c,r+=a)}d.push(t)}return d}function initAngleGrid(o,i,d){cols=floor(width/w),rows=floor(height/w);var h="even"===i?.005:.05;for(let n=0;n<cols+1;n++){angleGrid.push([]);for(let t=0;t<rows+1;t++){var a=t*h,c=n*h,a=(noiseDetail(8,.2),noise(a,c));let e,r;r=o&&"even"===i&&d?(e=5/6*PI,PI):!o&&"even"===i&&d?(e=PI,7/6*PI):o?(e=2/3*PI,4/3*PI):(e=4/3*PI,2/3*PI);c=map(a,0,1,e,r);angleGrid[n].push(-c)}}}function weightFunction(r,t){var n=t.reduce((e,r)=>e+r,0),o=Math.floor(rnd.random_dec()*n);for(let e=0;e<r.length;e++)if((n-=t[e])<=o)return r[e];return r[0]}function drawPadding(e,r){fill(r),stroke(r),strokeWeight(2*m),beginShape(),vertex(-e,-e),vertex(width+e,-e),vertex(width+e,height+e),vertex(-e,height+e),beginContour(),vertex(e,e),vertex(e,height-e),vertex(width-e,height-e),vertex(width-e,e),endContour(),endShape(CLOSE)}function drawBorder(e,r,t){fill(r),stroke(t),strokeWeight(2*m),strokeJoin(MITER),beginShape(),vertex(-e,-e),vertex(width+e,-e),vertex(width+e,height+e),vertex(-e,height+e),beginContour(),vertex(e,e),vertex(e,height-e),vertex(width-e,height-e),vertex(width-e,e),endContour(),endShape(CLOSE)}function getPalettes(){return[{name:"Sandstone",colors:["#f78888","#f3d250","#ececec","#90ccf4","#5da2d5"],stroke:"#000",background:rnd.random_choice(["#ececec","#5da2d5"]),weight:3},{name:"Redwall",colors:["#f0ede6","#d8c3a5","#8e8d8a","#e98074","#e84a4f"],stroke:"#000",background:rnd.random_choice(["#f0ede6","#e98074"]),weight:3},{name:"Plio",colors:["#edb7c7","#f0ede6","#bab2b5","#123c69","#ac3b61"],stroke:"#000",background:rnd.random_choice(["#f0ede6","#edb7c7"]),weight:3},{name:"Oligo",colors:["#f0ede6","#e27d60","#85dcbb","#e8a87c","#c38d9e","#41b3a3"],stroke:"#000",background:rnd.random_choice(["#f0ede6","#e27d60"]),weight:3},{name:"Kayenta",colors:["#f0ede6","#207178","#dc6378","#f1c694","#101652"],stroke:"#000",background:rnd.random_choice(["#f0ede6"]),weight:3},{name:"Charcoal",colors:["#464646","#3c3c3c","#323232","#282828","#1e1e1e"],stroke:"#fff",background:rnd.random_choice(["#1e1e1e"]),weight:1},{name:"Wingate",colors:["#260d0d","#319190","#ff4000","#ffc803","#f0ede6"],stroke:"#000",background:rnd.random_choice(["#f0ede6","#319190","#ff4000"]),weight:3},{name:"Magma",colors:["#D9BDAD","#D9653B","#BF9C8F","#D94625","#262626"],stroke:"#fff",background:rnd.random_choice(["#D9BDAD","#D9653B","#262626"]),weight:2},{name:"Steel",colors:["#A4B8BF","#EBF0F2","#6D878C","#31403E","#1A261C"],stroke:"#000",background:rnd.random_choice(["#EBF0F2","#6D878C","#1A261C"]),weight:2},{name:"Blue mineral",colors:["#063940","#195e63","#3e838c","#8ebdb6","#f0ede6"],stroke:"#000",background:rnd.random_choice(["#f0ede6","#8ebdb6"]),weight:3},{name:"Green mineral",colors:["#008584","#006666","#f5f5f5","#e9e9e9","#cccccc"],stroke:"#fff",background:rnd.random_choice(["#006666"]),weight:3},{name:"Moonshine",colors:["#1E0D2E","#341F4F","#59428A","#8C83E0","#C0C6FF"],stroke:"#000",background:rnd.random_choice(["#C0C6FF","#59428A"]),weight:1},{name:"Lava",colors:["#F2911B","#F2780C","#F25C05","#F24405","#f0ede6"],stroke:"#000",background:rnd.random_choice(["#f0ede6"]),weight:3},{name:"Pink opal",colors:["#f0ede6","#594842","#D9998B","#F2C1B6","#D98B84"],stroke:"#000",background:rnd.random_choice(["#f0ede6"]),weight:3}]}
